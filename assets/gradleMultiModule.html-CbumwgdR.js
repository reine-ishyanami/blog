import{_ as a,r as e,o as t,c as p,a as n,b as i,d as l,e as o}from"./app-Cxb9Ozmt.js";const c="/assets/gradleMultiMudole_01-DDaZi62i.png",r={},u=n("h1",{id:"gradle-多模块项目构建",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#gradle-多模块项目构建"},[n("span",null,"Gradle 多模块项目构建")])],-1),d={href:"https://github.com/reine-ishyanami/article/tree/master/code/gradle-multi-module",target:"_blank",rel:"noopener noreferrer"},v=o('<ol><li><p>演示项目的目录结构</p><p><img src="'+c+`" alt="project structure"></p></li><li><p>父项目 <code>gradle.properties</code> 用于定义一些用在 <code>build.gradle</code> 中的属性</p><div class="language-properties line-numbers-mode" data-highlighter="prismjs" data-ext="properties" data-title="properties"><pre class="language-properties"><code><span class="line"><span class="token key attr-name">group</span><span class="token punctuation">=</span><span class="token value attr-value">com.reine</span></span>
<span class="line"><span class="token key attr-name">version</span><span class="token punctuation">=</span><span class="token value attr-value">0.0.1</span></span>
<span class="line"><span class="token key attr-name">springbootVersion</span><span class="token punctuation">=</span><span class="token value attr-value">3.2.1</span></span>
<span class="line"><span class="token key attr-name">springManagementVersion</span><span class="token punctuation">=</span><span class="token value attr-value">1.1.4</span></span>
<span class="line"><span class="token key attr-name">javaVersion</span><span class="token punctuation">=</span><span class="token value attr-value">21</span></span>
<span class="line"><span class="token key attr-name">r2dbcMysqlVersion</span><span class="token punctuation">=</span><span class="token value attr-value">1.0.5</span></span>
<span class="line"><span class="token key attr-name">lombokVersion</span><span class="token punctuation">=</span><span class="token value attr-value">1.18.30</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>父项目 <code>build.gradle</code>，用于定义一些全局配置</p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">plugins <span class="token punctuation">{</span></span>
<span class="line">  id <span class="token string">&#39;java&#39;</span></span>
<span class="line">  id <span class="token interpolation-string"><span class="token string">&quot;java-library&quot;</span></span></span>
<span class="line">  id <span class="token string">&#39;org.springframework.boot&#39;</span> version <span class="token interpolation-string"><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">springbootVersion</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line">  id <span class="token string">&#39;io.spring.dependency-management&#39;</span> version <span class="token interpolation-string"><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">springManagementVersion</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 为所有模块定义，包括自身</span></span>
<span class="line">allprojects <span class="token punctuation">{</span></span>
<span class="line">  apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;java&quot;</span></span></span>
<span class="line"></span>
<span class="line">  java <span class="token punctuation">{</span></span>
<span class="line">      sourceCompatibility <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">javaVersion</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line">      targetCompatibility <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">javaVersion</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  repositories <span class="token punctuation">{</span></span>
<span class="line">      <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">  tasks<span class="token punctuation">.</span><span class="token function">withType</span><span class="token punctuation">(</span>JavaCompile<span class="token punctuation">)</span><span class="token punctuation">.</span>configureEach <span class="token punctuation">{</span></span>
<span class="line">      options<span class="token punctuation">.</span>encoding <span class="token operator">=</span> <span class="token string">&#39;UTF-8&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 为所有子模块定义</span></span>
<span class="line">subprojects <span class="token punctuation">{</span></span>
<span class="line">  dependencies <span class="token punctuation">{</span></span>
<span class="line">      annotationProcessor <span class="token interpolation-string"><span class="token string">&quot;org.projectlombok:lombok:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">lombokVersion</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line">      compileOnly <span class="token interpolation-string"><span class="token string">&quot;org.projectlombok:lombok:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">lombokVersion</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>父项目 <code>setting.gradle</code></p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">rootProject<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&#39;gradle-multi-module&#39;</span></span>
<span class="line">include <span class="token string">&#39;producer&#39;</span></span>
<span class="line">include <span class="token string">&#39;entity&#39;</span></span>
<span class="line">include <span class="token string">&#39;consumer&#39;</span></span>
<span class="line">include <span class="token string">&#39;http&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>entity</code> 模块的 <code>build.gradle</code></p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;org.springframework.boot&quot;</span></span></span>
<span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;io.spring.dependency-management&quot;</span></span></span>
<span class="line"></span>
<span class="line">dependencies <span class="token punctuation">{</span></span>
<span class="line"><span class="token comment">//    starter依赖可以不引入</span></span>
<span class="line"><span class="token comment">//    implementation &#39;org.springframework.boot:spring-boot-starter&#39;</span></span>
<span class="line">  <span class="token comment">// 因为实体类上用到了r2dbc的注解，故引入此依赖</span></span>
<span class="line">  implementation <span class="token string">&#39;org.springframework.boot:spring-boot-starter-data-r2dbc&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>producer</code> 模块的 <code>build.gradle</code></p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;org.springframework.boot&quot;</span></span></span>
<span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;io.spring.dependency-management&quot;</span></span></span>
<span class="line"></span>
<span class="line">dependencies <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 依赖entity模块</span></span>
<span class="line">  <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token function">project</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;:entity&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//    starter依赖可以不引入</span></span>
<span class="line"><span class="token comment">//    implementation &#39;org.springframework.boot:spring-boot-starter&#39;</span></span>
<span class="line">  implementation <span class="token string">&#39;org.springframework.boot:spring-boot-starter-data-r2dbc&#39;</span></span>
<span class="line">  implementation <span class="token string">&#39;org.springframework.boot:spring-boot-starter-webflux&#39;</span></span>
<span class="line">  implementation <span class="token interpolation-string"><span class="token string">&quot;io.asyncer:r2dbc-mysql:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span><span class="token expression">r2dbcMysqlVersion</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;</span></span></span>
<span class="line"><span class="token punctuation">}</span>    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>http</code> 模块的 <code>build.gradle</code></p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;org.springframework.boot&quot;</span></span></span>
<span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;io.spring.dependency-management&quot;</span></span></span>
<span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;java-library&quot;</span></span></span>
<span class="line"></span>
<span class="line">dependencies <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 传递依赖entity包</span></span>
<span class="line">  <span class="token function">api</span><span class="token punctuation">(</span><span class="token function">project</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;:entity&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//    starter依赖可以不引入</span></span>
<span class="line"><span class="token comment">//    implementation &#39;org.springframework.boot:spring-boot-starter&#39;</span></span>
<span class="line">  implementation <span class="token string">&#39;org.springframework.boot:spring-boot-starter-webflux&#39;</span></span>
<span class="line"><span class="token punctuation">}</span>    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>consumer</code> 模块的 <code>build.gradle</code></p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;org.springframework.boot&quot;</span></span></span>
<span class="line">apply plugin<span class="token punctuation">:</span> <span class="token interpolation-string"><span class="token string">&quot;io.spring.dependency-management&quot;</span></span></span>
<span class="line"></span>
<span class="line">dependencies <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token function">project</span><span class="token punctuation">(</span><span class="token interpolation-string"><span class="token string">&quot;:http&quot;</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token comment">//    starter依赖可以不引入</span></span>
<span class="line"><span class="token comment">//    implementation &#39;org.springframework.boot:spring-boot-starter&#39;</span></span>
<span class="line">  implementation <span class="token string">&#39;org.springframework.boot:spring-boot-starter-webflux&#39;</span></span>
<span class="line">  testImplementation <span class="token string">&#39;org.springframework.boot:spring-boot-starter-test&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line">test<span class="token punctuation">.</span>jvmArgs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">&quot;-XX:+EnableDynamicAgentLoading&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">tasks<span class="token punctuation">.</span><span class="token function">named</span><span class="token punctuation">(</span><span class="token string">&#39;test&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token function">useJUnitPlatform</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol>`,1);function m(k,g){const s=e("ExternalLinkIcon");return t(),p("div",null,[u,n("p",null,[n("a",d,[i("演示项目具体代码"),l(s)])]),v])}const y=a(r,[["render",m],["__file","gradleMultiModule.html.vue"]]),h=JSON.parse('{"path":"/blogs/dev/gradleMultiModule.html","title":"Gradle 多模块项目构建","lang":"zh-CN","frontmatter":{"title":"Gradle 多模块项目构建","date":"2023/1/16","tags":["SpringBoot"],"categories":["dev"]},"headers":[],"git":{"createdTime":1705390197000,"updatedTime":1722134881000,"contributors":[{"name":"reine-ishyanami","email":"2402979195@qq.com","commits":3}]},"filePathRelative":"blogs/dev/gradleMultiModule.md"}');export{y as comp,h as data};
