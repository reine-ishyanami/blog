import{_ as l,r as p,o as i,c,a as n,b as s,d as t,e}from"./app-Cxb9Ozmt.js";const o={},u=n("h1",{id:"graalvm-native-image-编译",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#graalvm-native-image-编译"},[n("span",null,"GraalVM native-image 编译")])],-1),d=n("h2",{id:"基础环境配置",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#基础环境配置"},[n("span",null,"基础环境配置")])],-1),r={href:"https://www.graalvm.org/downloads/",target:"_blank",rel:"noopener noreferrer"},k=e(`<li><p>配置 <code>JAVA_HOME</code> 和 <code>GRAALVM_HOME</code> 环境变量，内容为下载的 graalvm 的解压路径；将二进制文件，即 <code>%JAVA_HOME%\\bin</code> 添加到 <code>Path</code> 环境变量中</p></li><li><p>安装 native-image（新版graalvm已自带native-image，可省略此步骤）</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">gu.cmd <span class="token function">install</span> native-image</span>
<span class="line"><span class="token comment"># 也可以先下载native-image的jar然后手动安装</span></span>
<span class="line">gu.cmd <span class="token function">install</span> <span class="token parameter variable">-L</span> <span class="token operator">&lt;</span>jar包路径<span class="token operator">&gt;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,2),g={href:"https://wixtoolset.org/",target:"_blank",rel:"noopener noreferrer"},v={href:"https://visualstudio.microsoft.com/downloads/",target:"_blank",rel:"noopener noreferrer"},m=n("blockquote",null,[n("p",null,"选择以下组件"),n("ul",null,[n("li",null,"英语语言包"),n("li",null,"MSVC v142 - VS 2019 C++x64/x86生成工具（或者之后的版本）"),n("li",null,"Windows 10 SDK （10.0.19041.0 或者之后的版本）"),n("li",null,"MSVC v142 - VS 2019 C++ x64/x86 Spectre缓解库（和上面的生成工具版本一样）"),n("li",null,"对v142生成工具的C++/CLI支持（或者之后的版本）"),n("li",null,"Windows Universal CRT SDK")])],-1),b=e(`<li><p>查找对应的变量值</p><ul><li><p>vs msvc 的 bin 目录 <code>D:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\VC\\Tools\\MSVC\\14.35.32215\\bin\\Hostx64\\x64</code>，其中版本号 <code>2022\\Enterprise</code> 因选择的不同版本而有所差异，下面在配置环境变量时将 <code>D:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise</code> 简写为 <code>$vs</code></p></li><li><p>通过注册表获取 windows sdk 的安装目录，注册表路径 <code>计算机\\HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432Node\\Microsoft\\Microsoft SDKs\\Windows\\v10.0</code> 复制键为 <code>InstallationFolder</code> 的值，下面步骤会用到，简写为 <code>$windows10sdk</code></p></li></ul></li><li><p>需要添加的环境变量内容</p><p><strong>其中没有对应变量名的值，对应其往上最近的变量名</strong></p><table><thead><tr><th>变量名</th><th>内容</th></tr></thead><tbody><tr><td>Path</td><td>$vs\\VC\\Tools\\MSVC\\14.35.32215\\bin\\Hostx64\\x64</td></tr><tr><td></td><td>$windows10sdk\\bin\\10.0.20348.0\\x64</td></tr><tr><td>INCLUDE</td><td>$windows10sdk\\Include\\10.0.22000.0\\ucrt</td></tr><tr><td></td><td>$windows10sdk\\Include\\10.0.22000.0\\um</td></tr><tr><td></td><td>$windows10sdk\\Include\\10.0.22000.0\\shared</td></tr><tr><td></td><td>$vs\\VC\\Tools\\MSVC\\14.35.32215\\include</td></tr><tr><td>LIB</td><td>$windows10sdk\\Lib\\10.0.22000.0\\um\\x64</td></tr><tr><td></td><td>$windows10sdk\\Lib\\10.0.22000.0\\ucrt\\x64</td></tr><tr><td></td><td>$vs\\VC\\Tools\\MSVC\\14.35.32215\\lib\\x64</td></tr></tbody></table></li><li><p>编译测试</p><blockquote><p>新建 <code>HelloWorld.java</code> 文件，内容如下</p></blockquote><div class="language-java line-numbers-mode" data-highlighter="prismjs" data-ext="java" data-title="java"><pre class="language-java"><code><span class="line"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloWorld</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, World!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>编译测试</p></blockquote><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">javac HelloWorld.java</span>
<span class="line">native-image ./HelloWorld</span>
<span class="line">./HelloWorld <span class="token comment"># 出现Hello, World!代表环境配置成功</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,3),h=n("h2",{id:"springboot-项目",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#springboot-项目"},[n("span",null,"SpringBoot 项目")])],-1),x=n("p",null,"此章节依赖于上一章节的环境配置",-1),f=n("p",null,[n("strong",null,"GraalVM native-image 编译 SpringBoot3 项目")],-1),_={href:"https://docs.spring.io/spring-boot/docs/current/reference/html/native-image.html#native-image",target:"_blank",rel:"noopener noreferrer"},y=e(`<h3 id="maven-项目" tabindex="-1"><a class="header-anchor" href="#maven-项目"><span>maven 项目</span></a></h3><ol><li><p>创建 SpringBoot 项目，需要勾选 <code>GraalVM Native Support</code> 依赖</p><blockquote><p>项目的 <code>pom.xml</code> 会多出以下插件</p></blockquote><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.graalvm.buildtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>native-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">   ...</span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在 <code>pom.xml</code> 中添加程序入口类</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  ...</span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      ...</span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">&gt;</span></span>com.example.Application<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  ...</span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>执行命令</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">./mvnw <span class="token parameter variable">-Pnative</span> native:compile</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>可在 <code>project\\target</code> 文件夹中找到生成的可执行文件</p></li></ol><h3 id="gradle-项目" tabindex="-1"><a class="header-anchor" href="#gradle-项目"><span>gradle 项目</span></a></h3><ol><li><p>创建 SpringBoot 项目，需要勾选 <code>GraalVM Native Support</code> 依赖</p><blockquote><p>项目的<code>build.gradle</code>会多出以下插件</p></blockquote><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">plugins <span class="token punctuation">{</span></span>
<span class="line">   <span class="token punctuation">...</span></span>
<span class="line">   id <span class="token string">&#39;org.graalvm.buildtools.native&#39;</span> version <span class="token string">&#39;0.9.28&#39;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>执行命令 (gradle 项目无需手动配置主启动类)</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">./gradlew nativeCompile</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>可在 <code>project\\build\\native\\nativeCompile</code> 文件夹中找到生成的可执行文件</p></li></ol><h2 id="javafx-项目" tabindex="-1"><a class="header-anchor" href="#javafx-项目"><span>JavaFX 项目</span></a></h2><p><strong>GraalVM native-image 编译 JavaFX 项目</strong></p><p>请使用 IDEA 中的 JavaFX 创建项目</p><h3 id="maven-项目-1" tabindex="-1"><a class="header-anchor" href="#maven-项目-1"><span>maven 项目</span></a></h3>`,8),w={href:"https://github.com/gluonhq/gluonfx-maven-plugin",target:"_blank",rel:"noopener noreferrer"},j=e(`<li><p><code>pom.xml</code> 配置</p><div class="language-xml line-numbers-mode" data-highlighter="prismjs" data-ext="xml" data-title="xml"><pre class="language-xml"><code><span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  ...</span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      ...</span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">          ...</span>
<span class="line">          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.openjfx<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>javafx-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.0.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token comment">&lt;!-- Default configuration for running with: mvn clean javafx:run --&gt;</span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>default-cli<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">&gt;</span></span>com.reine.demo/com.reine.demo.HelloApplication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>launcher</span><span class="token punctuation">&gt;</span></span>app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>launcher</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jlinkZipName</span><span class="token punctuation">&gt;</span></span>app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jlinkZipName</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jlinkImageName</span><span class="token punctuation">&gt;</span></span>app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jlinkImageName</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noManPages</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noManPages</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>stripDebug</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>stripDebug</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>noHeaderFiles</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>noHeaderFiles</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token comment">&lt;!-- </span>
<span class="line">                          启动一次，对所有的UI控件进行功能测试，测试完成后正常关闭窗口，可以省略配置反射</span>
<span class="line">                          反射配置文件生成在resources目录下的META-INF/native-image目录下（如异常关闭则不会生成）</span>
<span class="line">                          如果项目文件比较多，不想配置反射或者不知道该怎么配置反射时，推荐使用这种方式</span>
<span class="line">                       --&gt;</span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>options</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>option</span><span class="token punctuation">&gt;</span></span>-agentlib:native-image-agent=config-merge-dir=src/main/resources/META-INF/native-image<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>option</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>options</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.gluonhq<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>gluonfx-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.0.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">&gt;</span></span>host<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bundlesList</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token comment">&lt;!--fxml文件--&gt;</span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>com.example.hello-view<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bundlesList</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>reflectionList</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                      <span class="token comment">&lt;!--controller控制器--&gt;</span></span>
<span class="line">                      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>list</span><span class="token punctuation">&gt;</span></span>com.example.HelloController<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>list</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>reflectionList</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">&gt;</span></span>com.example.HelloApplication<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">                  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>verbose</span><span class="token punctuation">&gt;</span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>verbose</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span></span>
<span class="line">  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span></span>
<span class="line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">&gt;</span></span>    </span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>编译</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">mvn javafx:run  <span class="token comment"># 第2步描述的启动一次，测试所有UI控件，生成反射文件</span></span>
<span class="line"></span>
<span class="line">mvn gluonfx:build <span class="token comment"># 执行此命令完成后可能需要等待一段时间，此命令执行完成后可以看的一个exe文件</span></span>
<span class="line"></span>
<span class="line">mvn gluonfx:nativerun <span class="token comment"># 运行生成的exe文件</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,2),I=n("h3",{id:"gradle-项目-1",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#gradle-项目-1"},[n("span",null,"gradle 项目")])],-1),M={href:"https://github.com/gluonhq/gluonfx-gradle-plugin",target:"_blank",rel:"noopener noreferrer"},V=e(`<li><p><code>build.gradle</code> 配置</p><div class="language-groovy line-numbers-mode" data-highlighter="prismjs" data-ext="groovy" data-title="groovy"><pre class="language-groovy"><code><span class="line">buildscript <span class="token punctuation">{</span></span>
<span class="line">  repositories <span class="token punctuation">{</span></span>
<span class="line">      maven <span class="token punctuation">{</span></span>
<span class="line">          url <span class="token interpolation-string"><span class="token string">&quot;https://plugins.gradle.org/m2/&quot;</span></span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  dependencies <span class="token punctuation">{</span></span>
<span class="line">      classpath <span class="token string">&#39;com.gluonhq:gluonfx-gradle-plugin:1.0.22&#39;</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line">apply plugin<span class="token punctuation">:</span> <span class="token string">&#39;com.gluonhq.gluonfx-gradle-plugin&#39;</span>    </span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 配置主启动类，记得修改成自己的主启动类的全限定名</span></span>
<span class="line">mainClassName <span class="token operator">=</span> <span class="token string">&#39;com.example.HelloApplication&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 启动一次，对所有的UI控件进行功能测试，测试完成后正常关闭窗口，可以省略配置反射</span></span>
<span class="line"><span class="token comment">// 反射配置文件生成在resources目录下的META-INF/native-image目录下（如异常关闭则不会生成）</span></span>
<span class="line"><span class="token comment">// 如果项目文件比较多，不想配置反射或者不知道该怎么配置反射时，推荐使用这种方式</span></span>
<span class="line">run <span class="token punctuation">{</span></span>
<span class="line">  jvmArgs<span class="token operator">=</span><span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">&quot;-agentlib:native-image-agent=config-merge-dir=src/main/resources/META-INF/native-image&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 一些自定义的插件配置，可以不写</span></span>
<span class="line">gluonfx <span class="token punctuation">{</span></span>
<span class="line">  <span class="token comment">// 一般填host</span></span>
<span class="line">  target <span class="token operator">=</span> <span class="token interpolation-string"><span class="token string">&quot;host&quot;</span></span></span>
<span class="line">  bundlesList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">&quot;com.example.hello-view&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line">  reflectionList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token interpolation-string"><span class="token string">&quot;com.example.HelloController&quot;</span></span><span class="token punctuation">]</span></span>
<span class="line">  verbose <span class="token operator">=</span> <span class="token boolean">false</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>编译</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="line">gradle run  <span class="token comment"># 第2步描述的启动一次，测试所有UI控件，生成反射文件</span></span>
<span class="line"></span>
<span class="line">gradle nativeBuild <span class="token comment"># 执行此命令完成后可能需要等待一段时间，此命令执行完成后可以看的一个exe文件</span></span>
<span class="line"></span>
<span class="line">gradle nativeRun <span class="token comment"># 运行生成的exe文件</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li>`,2),C=n("h3",{id:"附录",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#附录"},[n("span",null,"附录")])],-1),q=n("blockquote",null,[n("p",null,"javafx gradle 项目的 windows graalvm 打包脚本(github action workflow)，需要先运行 gradle run 生成反射配置并上传到远程仓库")],-1),S=n("p",null,[n("strong",null,"相关链接")],-1),N={href:"https://github.com/marketplace/actions/github-action-for-graalvm",target:"_blank",rel:"noopener noreferrer"},H={href:"https://docs.github.com/zh/actions/publishing-packages/publishing-java-packages-with-gradle",target:"_blank",rel:"noopener noreferrer"},A=e(`<div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml" data-title="yml"><pre class="language-yaml"><code><span class="line"><span class="token key atrule">name</span><span class="token punctuation">:</span> Windows Native<span class="token punctuation">-</span>Image Build</span>
<span class="line"><span class="token comment"># 定义在推送 tag 时触发工作流程与手动触发工作流程</span></span>
<span class="line"><span class="token key atrule">on</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">push</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">tags</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token string">&#39;*&#39;</span></span>
<span class="line">  <span class="token key atrule">workflow_dispatch</span><span class="token punctuation">:</span></span>
<span class="line"><span class="token key atrule">jobs</span><span class="token punctuation">:</span></span>
<span class="line">  <span class="token key atrule">build</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token key atrule">runs-on</span><span class="token punctuation">:</span> windows<span class="token punctuation">-</span>latest</span>
<span class="line">    <span class="token key atrule">steps</span><span class="token punctuation">:</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/checkout@v4</span>
<span class="line">      <span class="token comment"># 安装 GraalVM，配置JAVA_HOME GRAALVM_HOME</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Setup GraalVM</span>
<span class="line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> graalvm/setup<span class="token punctuation">-</span>graalvm@v1</span>
<span class="line">        <span class="token key atrule">with</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token key atrule">java-version</span><span class="token punctuation">:</span> <span class="token string">&#39;21&#39;</span></span>
<span class="line">          <span class="token key atrule">distribution</span><span class="token punctuation">:</span> <span class="token string">&#39;graalvm-community&#39;</span></span>
<span class="line">          <span class="token key atrule">github-token</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span><span class="token punctuation">{</span> secrets.GITHUB_TOKEN <span class="token punctuation">}</span><span class="token punctuation">}</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Validate Gradle wrapper</span>
<span class="line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> gradle/wrapper<span class="token punctuation">-</span>validation<span class="token punctuation">-</span>action@ccb4328a959376b642e027874838f60f8e596de3</span>
<span class="line">      <span class="token comment"># 使用 Gradle 构建您的项目</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> GraalVM Native Build</span>
<span class="line">        <span class="token key atrule">run</span><span class="token punctuation">:</span></span>
<span class="line">          .\\gradlew nativeBuild</span>
<span class="line">      <span class="token comment"># 上传打包完成后的产品，以供下载</span></span>
<span class="line">      <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Upload</span>
<span class="line">        <span class="token key atrule">uses</span><span class="token punctuation">:</span> actions/upload<span class="token punctuation">-</span>artifact@v2</span>
<span class="line">        <span class="token key atrule">with</span><span class="token punctuation">:</span></span>
<span class="line">          <span class="token comment"># 打包后的压缩包名称</span></span>
<span class="line">          <span class="token key atrule">name</span><span class="token punctuation">:</span> XXX</span>
<span class="line">          <span class="token key atrule">path</span><span class="token punctuation">:</span> build/gluonfx/x86_64<span class="token punctuation">-</span>windows/<span class="token important">*.exe</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1);function E(L,B){const a=p("ExternalLinkIcon");return i(),c("div",null,[u,d,n("ol",null,[n("li",null,[n("p",null,[s("下载"),n("a",r,[s("graalvm"),t(a)])])]),k,n("li",null,[n("p",null,[s("安装"),n("a",g,[s("wixtoolset"),t(a)])])]),n("li",null,[n("p",null,[s("下载"),n("a",v,[s("Microsoft Visual Studio"),t(a)])]),m]),b]),h,x,f,n("p",null,[n("a",_,[s("官方地址"),t(a)])]),y,n("ol",null,[n("li",null,[n("p",null,[n("a",w,[s("插件主页"),t(a)])])]),j]),I,n("ol",null,[n("li",null,[n("p",null,[n("a",M,[s("插件主页"),t(a)])])]),V]),C,q,S,n("p",null,[n("a",N,[s("graalvm"),t(a)])]),n("p",null,[n("a",H,[s("gradle"),t(a)])]),A])}const G=l(o,[["render",E],["__file","graalvmNative.html.vue"]]),T=JSON.parse('{"path":"/blogs/dev/graalvmNative.html","title":"GraalVM native-image 编译","lang":"zh-CN","frontmatter":{"title":"GraalVM native-image 编译","date":"2023/7/22","tags":["JavaFX","SpringBoot"],"categories":["dev"]},"headers":[{"level":2,"title":"基础环境配置","slug":"基础环境配置","link":"#基础环境配置","children":[]},{"level":2,"title":"SpringBoot 项目","slug":"springboot-项目","link":"#springboot-项目","children":[{"level":3,"title":"maven 项目","slug":"maven-项目","link":"#maven-项目","children":[]},{"level":3,"title":"gradle 项目","slug":"gradle-项目","link":"#gradle-项目","children":[]}]},{"level":2,"title":"JavaFX 项目","slug":"javafx-项目","link":"#javafx-项目","children":[{"level":3,"title":"maven 项目","slug":"maven-项目-1","link":"#maven-项目-1","children":[]},{"level":3,"title":"gradle 项目","slug":"gradle-项目-1","link":"#gradle-项目-1","children":[]},{"level":3,"title":"附录","slug":"附录","link":"#附录","children":[]}]}],"git":{"createdTime":1689907574000,"updatedTime":1722134881000,"contributors":[{"name":"reine-ishyanami","email":"2402979195@qq.com","commits":3}]},"filePathRelative":"blogs/dev/graalvmNative.md"}');export{G as comp,T as data};
